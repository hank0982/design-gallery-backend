(self.webpackChunkdesign_gallery=self.webpackChunkdesign_gallery||[]).push([[232],{753:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return(0,r.default)(t),o.test(t)};var i,r=(i=n(6723))&&i.__esModule?i:{default:i},o=/^(0x|0h)?[0-9A-F]+$/i;t.exports=e.default,t.exports.default=e.default},4857:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return(0,i.default)(t),(0,r.default)(t)&&24===t.length};var i=o(n(6723)),r=o(n(753));function o(t){return t&&t.__esModule?t:{default:t}}t.exports=e.default,t.exports.default=e.default},6723:(t,e)=>{"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){if(!("string"==typeof t||t instanceof String)){var e=n(t);throw null===t?e="null":"object"===e&&(e=t.constructor.name),new TypeError("Expected a string but received a ".concat(e))}},t.exports=e.default,t.exports.default=e.default},4232:(t,e,n)=>{"use strict";n.r(e),n.d(e,{MetadataCollectionModule:()=>U});var i=n(1116),r=n(9886),o=n(3845),s=n(3148),c=n(3530),a=n(6599),u=n(3406),l=n(4762),d=n(8531),p=n(4857),g=n.n(p);function f(t){return(0,d.Y)({name:"isMongoId",validator:{validate:(t,e)=>function(t){return"string"==typeof t&&g()(t)}(t),defaultMessage:(0,d.l)(t=>t+"$property must be a mongodb id",t)}},t)}var h=n(5901);let v=(()=>{class t{}return(0,l.gn)([f()],t.prototype,"designId",void 0),(0,l.gn)([f()],t.prototype,"raterId",void 0),(0,l.gn)([(e=u.u,(0,d.Y)({name:"isEnum",constraints:[e],validator:{validate:(t,e)=>function(t,e){return Object.keys(e).map(t=>e[t]).indexOf(t)>=0}(t,e.constraints[0]),defaultMessage:(0,d.l)(t=>t+"$property must be a valid enum value",n)}},n))],t.prototype,"aspect",void 0),(0,l.gn)([(0,h.qA)()],t.prototype,"rating",void 0),t;var e,n})();var m=n(7368),x=n(4009),Z=n(2693);let A=(()=>{class t{constructor(t){this.http=t}fetchRatingByRaterIdAndDesignId(t,e){return this.http.get(`api/ratings?raterId=${t}&designId=${e}`)}createOrUpdateRating(t){return this.http.post("api/ratings",t)}}return t.\u0275fac=function(e){return new(e||t)(m.LFG(Z.eN))},t.\u0275prov=m.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var M=n(3402),C=n(9996);let I=(()=>{class t{constructor(t){this.http=t}fetchUserById(t){return this.http.get(`api/users/${t}`)}fetchUserRatedProjects(t){return this.http.get(`api/users/${t}/rated-projects`).pipe((0,C.U)(t=>{const e={};return t.forEach(t=>e[t._id]=t.hasComplete),e}))}}return t.\u0275fac=function(e){return new(e||t)(m.LFG(Z.eN))},t.\u0275prov=m.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var O=n(1419),P=n(6225),_=n(1041),b=n(1293);function R(t,e){if(1&t&&(m.TgZ(0,"div",9),m._UZ(1,"div"),m.TgZ(2,"div"),m._UZ(3,"img",10),m.qZA(),m._UZ(4,"div"),m.TgZ(5,"div"),m._UZ(6,"img",10),m.qZA(),m.qZA()),2&t){const t=e.$implicit;m.xp6(3),m.Q6J("src",t[0].imageUrl,m.LSH),m.xp6(3),m.Q6J("src",t[1].imageUrl,m.LSH)}}function y(t,e){if(1&t){const t=m.EpF();m.TgZ(0,"div",15),m.TgZ(1,"input",16),m.NdJ("ngModelChange",function(e){m.CHM(t);const n=m.oxw().$implicit;return m.oxw().principleRatings[0][n]=e})("ngModelChange",function(){m.CHM(t);const e=m.oxw().$implicit;return m.oxw().clickOption(0,e)}),m.qZA(),m.TgZ(2,"a",17),m.NdJ("click",function(){const e=m.CHM(t).$implicit,n=m.oxw().$implicit;return m.oxw().checkPreviousRating(n,e)}),m._uU(3),m.qZA(),m.qZA()}if(2&t){const t=e.$implicit,n=m.oxw().$implicit,i=m.oxw();m.xp6(1),m.MGl("name","inlineRadio-",n,"-0"),m.hYB("id","inlineRadio-",t,"-",n,"-0"),m.Q6J("value",t)("ngModel",i.principleRatings[0][n]),m.xp6(2),m.Oqu(t)}}function T(t,e){if(1&t){const t=m.EpF();m.TgZ(0,"div",15),m.TgZ(1,"input",16),m.NdJ("ngModelChange",function(e){m.CHM(t);const n=m.oxw().$implicit;return m.oxw().principleRatings[1][n]=e})("ngModelChange",function(){m.CHM(t);const e=m.oxw().$implicit;return m.oxw().clickOption(1,e)}),m.qZA(),m.TgZ(2,"a",17),m.NdJ("click",function(){const e=m.CHM(t).$implicit,n=m.oxw().$implicit;return m.oxw().checkPreviousRating(n,e)}),m._uU(3),m.qZA(),m.qZA()}if(2&t){const t=e.$implicit,n=m.oxw().$implicit,i=m.oxw();m.xp6(1),m.MGl("name","inlineRadio-",n,"-1"),m.hYB("id","inlineRadio-",t,"-",n,"-1"),m.Q6J("value",t)("ngModel",i.principleRatings[1][n]),m.xp6(2),m.Oqu(t)}}function S(t,e){if(1&t&&(m.TgZ(0,"div",11),m.TgZ(1,"div",12),m.TgZ(2,"span"),m._uU(3),m.ALo(4,"titlecase"),m.qZA(),m.qZA(),m.TgZ(5,"div",13),m.YNc(6,y,4,6,"div",14),m.qZA(),m.TgZ(7,"div",12),m.TgZ(8,"span"),m._uU(9),m.ALo(10,"titlecase"),m.qZA(),m.qZA(),m.TgZ(11,"div",13),m.YNc(12,T,4,6,"div",14),m.qZA(),m.qZA()),2&t){const t=e.$implicit,n=m.oxw();m.xp6(3),m.Oqu(m.lcZ(4,4,t)),m.xp6(3),m.Q6J("ngForOf",n.ratings),m.xp6(3),m.Oqu(m.lcZ(10,6,t)),m.xp6(3),m.Q6J("ngForOf",n.ratings)}}const w=function(t,e){return{"current-item":t,"finished-item":e}};function q(t,e){if(1&t){const t=m.EpF();m.TgZ(0,"div",18),m.NdJ("click",function(){const e=m.CHM(t).index;return m.oxw().changeCurrentIndex(e)}),m.TgZ(1,"span"),m._uU(2),m.qZA(),m.qZA()}if(2&t){const t=e.$implicit,n=e.index,i=m.oxw();m.Q6J("ngClass",m.WLB(2,w,i.currentIndex===n,i.userMetadata?i.userMetadata.ratedProjects[t._id]:void 0)),m.xp6(2),m.Oqu(n+1)}}function N(t,e){1&t&&(m.TgZ(0,"div",19),m.TgZ(1,"div",20),m.TgZ(2,"span",21),m._uU(3,"\xd7"),m.qZA(),m.TgZ(4,"p"),m._uU(5,"Some text in the Modal.."),m.qZA(),m.qZA(),m.qZA())}let k=(()=>{class t{constructor(t,e,n,i,r){this.route=t,this.designService=e,this.ratingService=n,this.projectsService=i,this.usersService=r,this.currentIndex=0,this.principleRatings={0:{[u.u.ALIGNMENT]:0,[u.u.APPROPRIATENESS]:0,[u.u.CONSISTENCY]:0,[u.u.EMPHASIS]:0,[u.u.HIERARCHY]:0},1:{[u.u.ALIGNMENT]:0,[u.u.APPROPRIATENESS]:0,[u.u.CONSISTENCY]:0,[u.u.EMPHASIS]:0,[u.u.HIERARCHY]:0}},this.isModalVisible=!0,this.ratings=[1,2,3,4,5],this.designPrinciples=[...Object.values(u.u)]}ngOnInit(){this.fetchRaterMetadata(),this.projectsService.fetchAllProjects(0,0).pipe((0,c.P)()).subscribe(t=>{this.projects=t.results,this.refetchNewDesigns()})}fetchRaterMetadata(){const t=this.route.snapshot.paramMap.get("id");t&&(0,s.D)({userInfo:this.usersService.fetchUserById(t),ratedProjects:this.usersService.fetchUserRatedProjects(t)}).pipe((0,c.P)()).subscribe(t=>{this.userMetadata=t})}changeCurrentIndex(t){this.currentIndex=t,this.currentDesigns=void 0,this.refetchNewDesigns(),this.principleRatings={0:{[u.u.ALIGNMENT]:0,[u.u.APPROPRIATENESS]:0,[u.u.CONSISTENCY]:0,[u.u.EMPHASIS]:0,[u.u.HIERARCHY]:0},1:{[u.u.ALIGNMENT]:0,[u.u.APPROPRIATENESS]:0,[u.u.CONSISTENCY]:0,[u.u.EMPHASIS]:0,[u.u.HIERARCHY]:0}}}checkPreviousRating(t,e){console.log(t),console.log(e)}areAllPrinciplesInCurrentDesignRated(){let t=!0;return[0,1].forEach(e=>{Object.values(u.u).forEach(n=>{this.principleRatings[e][n]<=0&&(t=!1)})}),t}clickOption(t,e){const n=this.route.snapshot.paramMap.get("id");n&&this.currentDesigns&&this.ratingService.createOrUpdateRating((0,o.d8)(v,{raterId:n,designId:this.currentDesigns[t]._id,rating:this.principleRatings[t][e],aspect:e})).subscribe(t=>{this.areAllPrinciplesInCurrentDesignRated()&&(this.fetchRaterMetadata(),this.changeCurrentIndex(this.currentIndex+1))})}refetchNewDesigns(){const t=this.route.snapshot.paramMap.get("id");this.projects&&t&&(0,s.D)(this.projects[this.currentIndex].designIds.map(t=>this.designService.fetchDesignById(t))).pipe((0,a.b)(t=>console.log(t),(0,c.P)())).subscribe(e=>{this.currentDesigns=e,this.ratingService.fetchRatingByRaterIdAndDesignId(t,e[1]._id).pipe((0,c.P)()).subscribe(t=>{var e,n;(null===(n=null===(e=null==t?void 0:t.results)||void 0===e?void 0:e[0])||void 0===n?void 0:n.rating)&&(this.principleRatings[1]=t.results[0].rating)}),this.ratingService.fetchRatingByRaterIdAndDesignId(t,e[0]._id).pipe((0,c.P)()).subscribe(t=>{var e,n;(null===(n=null===(e=null==t?void 0:t.results)||void 0===e?void 0:e[0])||void 0===n?void 0:n.rating)&&(this.principleRatings[0]=t.results[0].rating)})})}}return t.\u0275fac=function(e){return new(e||t)(m.Y36(r.gz),m.Y36(x.i),m.Y36(A),m.Y36(M.m),m.Y36(I))},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-metadata-collection"]],decls:16,vars:5,consts:[[1,"container"],["gdColumn","",1,"option-container"],["gdColumns","150px 1fr 150px 1fr",4,"ngIf"],[1,"rating-subtitle"],["gdColumns","150px 1fr 150px 1fr","class","options",4,"ngFor","ngForOf"],["gdColumn","",1,"pagniation-container"],["fxLayout","row wrap","width","100%"],["fxFlex","30px","class","item",3,"ngClass","click",4,"ngFor","ngForOf"],["class","modal",4,"ngIf"],["gdColumns","150px 1fr 150px 1fr"],[3,"src"],["gdColumns","150px 1fr 150px 1fr",1,"options"],[1,"subtitle"],["gdColumns","1fr 1fr 1fr 1fr 1fr",1,"ratings"],["class","form-check col-auto form-check-inline",4,"ngFor","ngForOf"],[1,"form-check","col-auto","form-check-inline"],["type","radio",1,"form-check-input",3,"name","value","id","ngModel","ngModelChange"],[1,"form-check-label",3,"click"],["fxFlex","30px",1,"item",3,"ngClass","click"],[1,"modal"],[1,"modal-content"],[1,"close"]],template:function(t,e){1&t&&(m.TgZ(0,"div",0),m.TgZ(1,"div",1),m.TgZ(2,"h4"),m._uU(3),m.qZA(),m.TgZ(4,"h4"),m._uU(5,"Designs"),m.qZA(),m.YNc(6,R,7,2,"div",2),m.TgZ(7,"h4",3),m._uU(8,"Rating"),m.qZA(),m.YNc(9,S,13,8,"div",4),m.qZA(),m.TgZ(10,"div",5),m.TgZ(11,"h4"),m._uU(12,"All projects"),m.qZA(),m.TgZ(13,"div",6),m.YNc(14,q,3,5,"div",7),m.qZA(),m.qZA(),m.qZA(),m.YNc(15,N,6,0,"div",8)),2&t&&(m.xp6(3),m.hij("Project: ",e.currentIndex+1,""),m.xp6(3),m.Q6J("ngIf",e.currentDesigns),m.xp6(3),m.Q6J("ngForOf",e.designPrinciples),m.xp6(5),m.Q6J("ngForOf",e.projects),m.xp6(1),m.Q6J("ngIf",e.isModalVisible))},directives:[O.Dl,i.O5,i.sg,P.xw,O.OY,_._,_.Fj,_.JJ,_.On,P.yH,b.oO,i.mk],pipes:[i.rS],styles:[".item[_ngcontent-%COMP%]{border:1px solid #000;text-align:center;line-height:30px;width:30px;height:30px;cursor:pointer}.item[_ngcontent-%COMP%]:hover{background-color:#0000004d}.finished-item[_ngcontent-%COMP%]{background-color:#08ad084d}.current-item[_ngcontent-%COMP%]{background-color:#000;color:#fff}.form-check-label[_ngcontent-%COMP%]{cursor:pointer}.pagniation-container[_ngcontent-%COMP%]{margin:100px 10px 10px;width:100%}.option-container[_ngcontent-%COMP%]{margin:10px;width:100%}.options[_ngcontent-%COMP%]{margin-top:20px}img[_ngcontent-%COMP%]{width:100%}.item[_ngcontent-%COMP%]{margin:10px}.rating-subtitle[_ngcontent-%COMP%]{margin-top:70px}.subtitle[_ngcontent-%COMP%]{width:100%;text-align:right}.ratings[_ngcontent-%COMP%]{padding-left:70px;padding-right:70px}.modal[_ngcontent-%COMP%]{display:none;position:fixed;z-index:1;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:#000;background-color:#0006}.modal-content[_ngcontent-%COMP%]{background-color:#fefefe;margin:15% auto;padding:20px;border:1px solid #888;width:80%}.close[_ngcontent-%COMP%]{color:#aaa;float:right;font-size:28px;font-weight:700}.close[_ngcontent-%COMP%]:focus, .close[_ngcontent-%COMP%]:hover{color:#000;text-decoration:none;cursor:pointer;display:inline-block}"]}),t})(),E=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=m.Xpm({type:t,selectors:[["ng-component"]],decls:5,vars:0,consts:[[1,"containerr"],[1,"row","justify-content-center"],[1,"col-2"]],template:function(t,e){1&t&&(m.TgZ(0,"div",0),m.TgZ(1,"div",1),m.TgZ(2,"div",2),m.TgZ(3,"h1"),m._uU(4,"404 Not Found"),m.qZA(),m.qZA(),m.qZA(),m.qZA())},styles:[""]}),t})();var Y=n(6277);const j=[{path:"",component:E},{path:":id",component:k}];let U=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=m.oAB({type:t}),t.\u0275inj=m.cJS({imports:[[_.u5,Y.o9,i.ez,r.Bz.forChild(j)]]}),t})()}}]);