(self.webpackChunkdesign_gallery=self.webpackChunkdesign_gallery||[]).push([[336],{5336:(t,e,i)=>{"use strict";i.r(e),i.d(e,{RatingCollectionModule:()=>x});var r=i(1116),n=i(3464),o=i(3530),a=i(9996),u=i(3148),s=i(878),Z=i(1041),d=i(3406),g=i(5366),c=i(3805),p=i(6242),l=i(4009),m=i(2878),h=i(1419),A=i(4369),q=i(5965),v=i(7681),f=i(1293);function T(t,e){if(1&t&&g._UZ(0,"img",8),2&t){const t=g.oxw();g.s9C("src",t.currentImages[0].url,g.LSH)}}function _(t,e){if(1&t&&g._UZ(0,"img",8),2&t){const t=g.oxw();g.s9C("src",t.currentImages[1].url,g.LSH)}}function U(t,e){if(1&t&&(g.TgZ(0,"div",9),g.TgZ(1,"table",10),g.TgZ(2,"thead"),g.TgZ(3,"tr",11),g._UZ(4,"th",12),g.TgZ(5,"th",13),g._uU(6,"1"),g.qZA(),g.TgZ(7,"th",13),g._uU(8,"2"),g.qZA(),g.TgZ(9,"th",13),g._uU(10,"3"),g.qZA(),g.TgZ(11,"th",13),g._uU(12,"4"),g.qZA(),g.TgZ(13,"th",13),g._uU(14,"5"),g.qZA(),g.TgZ(15,"th",13),g._uU(16,"6"),g.qZA(),g.TgZ(17,"th",13),g._uU(18,"7"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(19,"tbody"),g.TgZ(20,"tr",11),g.TgZ(21,"th",14),g._uU(22,"Appropriateness"),g.qZA(),g.TgZ(23,"td",15),g._UZ(24,"input",16),g.qZA(),g.TgZ(25,"td",15),g._UZ(26,"input",17),g.qZA(),g.TgZ(27,"td",15),g._UZ(28,"input",18),g.qZA(),g.TgZ(29,"td",15),g._UZ(30,"input",19),g.qZA(),g.TgZ(31,"td",15),g._UZ(32,"input",20),g.qZA(),g.TgZ(33,"td",15),g._UZ(34,"input",21),g.qZA(),g.TgZ(35,"td",15),g._UZ(36,"input",22),g.qZA(),g.qZA(),g.TgZ(37,"tr",11),g.TgZ(38,"th",14),g._uU(39,"Emphasis"),g.qZA(),g.TgZ(40,"td",15),g._UZ(41,"input",23),g.qZA(),g.TgZ(42,"td",15),g._UZ(43,"input",24),g.qZA(),g.TgZ(44,"td",15),g._UZ(45,"input",25),g.qZA(),g.TgZ(46,"td",15),g._UZ(47,"input",26),g.qZA(),g.TgZ(48,"td",15),g._UZ(49,"input",27),g.qZA(),g.TgZ(50,"td",15),g._UZ(51,"input",28),g.qZA(),g.TgZ(52,"td",15),g._UZ(53,"input",29),g.qZA(),g.qZA(),g.TgZ(54,"tr",11),g.TgZ(55,"th",14),g._uU(56,"Alignment"),g.qZA(),g.TgZ(57,"td",15),g._UZ(58,"input",30),g.qZA(),g.TgZ(59,"td",15),g._UZ(60,"input",31),g.qZA(),g.TgZ(61,"td",15),g._UZ(62,"input",32),g.qZA(),g.TgZ(63,"td",15),g._UZ(64,"input",33),g.qZA(),g.TgZ(65,"td",15),g._UZ(66,"input",34),g.qZA(),g.TgZ(67,"td",15),g._UZ(68,"input",35),g.qZA(),g.TgZ(69,"td",15),g._UZ(70,"input",36),g.qZA(),g.qZA(),g.TgZ(71,"tr",11),g.TgZ(72,"th",14),g._uU(73,"Hierarchy"),g.qZA(),g.TgZ(74,"td",15),g._UZ(75,"input",37),g.qZA(),g.TgZ(76,"td",15),g._UZ(77,"input",38),g.qZA(),g.TgZ(78,"td",15),g._UZ(79,"input",39),g.qZA(),g.TgZ(80,"td",15),g._UZ(81,"input",40),g.qZA(),g.TgZ(82,"td",15),g._UZ(83,"input",41),g.qZA(),g.TgZ(84,"td",15),g._UZ(85,"input",42),g.qZA(),g.TgZ(86,"td",15),g._UZ(87,"input",43),g.qZA(),g.qZA(),g.TgZ(88,"tr",11),g.TgZ(89,"th",14),g._uU(90,"Consistency"),g.qZA(),g.TgZ(91,"td",15),g._UZ(92,"input",44),g.qZA(),g.TgZ(93,"td",15),g._UZ(94,"input",45),g.qZA(),g.TgZ(95,"td",15),g._UZ(96,"input",46),g.qZA(),g.TgZ(97,"td",15),g._UZ(98,"input",47),g.qZA(),g.TgZ(99,"td",15),g._UZ(100,"input",48),g.qZA(),g.TgZ(101,"td",15),g._UZ(102,"input",49),g.qZA(),g.TgZ(103,"td",15),g._UZ(104,"input",50),g.qZA(),g.qZA(),g.TgZ(105,"tr",11),g.TgZ(106,"th",14),g._uU(107,"Readability "),g.qZA(),g.TgZ(108,"td",15),g._UZ(109,"input",51),g.qZA(),g.TgZ(110,"td",15),g._UZ(111,"input",52),g.qZA(),g.TgZ(112,"td",15),g._UZ(113,"input",53),g.qZA(),g.TgZ(114,"td",15),g._UZ(115,"input",54),g.qZA(),g.TgZ(116,"td",15),g._UZ(117,"input",55),g.qZA(),g.TgZ(118,"td",15),g._UZ(119,"input",56),g.qZA(),g.TgZ(120,"td",15),g._UZ(121,"input",57),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(122,"table",58),g.TgZ(123,"thead"),g.TgZ(124,"tr",11),g._UZ(125,"th",12),g.TgZ(126,"th",13),g._uU(127,"1"),g.qZA(),g.TgZ(128,"th",13),g._uU(129,"2"),g.qZA(),g.TgZ(130,"th",13),g._uU(131,"3"),g.qZA(),g.TgZ(132,"th",13),g._uU(133,"4"),g.qZA(),g.TgZ(134,"th",13),g._uU(135,"5"),g.qZA(),g.TgZ(136,"th",13),g._uU(137,"6"),g.qZA(),g.TgZ(138,"th",13),g._uU(139,"7"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(140,"tbody"),g.TgZ(141,"tr",11),g.TgZ(142,"th",14),g._uU(143,"Appropriateness"),g.qZA(),g.TgZ(144,"td",15),g._UZ(145,"input",16),g.qZA(),g.TgZ(146,"td",15),g._UZ(147,"input",17),g.qZA(),g.TgZ(148,"td",15),g._UZ(149,"input",18),g.qZA(),g.TgZ(150,"td",15),g._UZ(151,"input",19),g.qZA(),g.TgZ(152,"td",15),g._UZ(153,"input",20),g.qZA(),g.TgZ(154,"td",15),g._UZ(155,"input",21),g.qZA(),g.TgZ(156,"td",15),g._UZ(157,"input",22),g.qZA(),g.qZA(),g.TgZ(158,"tr",11),g.TgZ(159,"th",14),g._uU(160,"Emphasis"),g.qZA(),g.TgZ(161,"td",15),g._UZ(162,"input",23),g.qZA(),g.TgZ(163,"td",15),g._UZ(164,"input",24),g.qZA(),g.TgZ(165,"td",15),g._UZ(166,"input",25),g.qZA(),g.TgZ(167,"td",15),g._UZ(168,"input",26),g.qZA(),g.TgZ(169,"td",15),g._UZ(170,"input",27),g.qZA(),g.TgZ(171,"td",15),g._UZ(172,"input",28),g.qZA(),g.TgZ(173,"td",15),g._UZ(174,"input",29),g.qZA(),g.qZA(),g.TgZ(175,"tr",11),g.TgZ(176,"th",14),g._uU(177,"Alignment"),g.qZA(),g.TgZ(178,"td",15),g._UZ(179,"input",30),g.qZA(),g.TgZ(180,"td",15),g._UZ(181,"input",31),g.qZA(),g.TgZ(182,"td",15),g._UZ(183,"input",32),g.qZA(),g.TgZ(184,"td",15),g._UZ(185,"input",33),g.qZA(),g.TgZ(186,"td",15),g._UZ(187,"input",34),g.qZA(),g.TgZ(188,"td",15),g._UZ(189,"input",35),g.qZA(),g.TgZ(190,"td",15),g._UZ(191,"input",36),g.qZA(),g.qZA(),g.TgZ(192,"tr",11),g.TgZ(193,"th",14),g._uU(194,"Hierarchy"),g.qZA(),g.TgZ(195,"td",15),g._UZ(196,"input",37),g.qZA(),g.TgZ(197,"td",15),g._UZ(198,"input",38),g.qZA(),g.TgZ(199,"td",15),g._UZ(200,"input",39),g.qZA(),g.TgZ(201,"td",15),g._UZ(202,"input",40),g.qZA(),g.TgZ(203,"td",15),g._UZ(204,"input",41),g.qZA(),g.TgZ(205,"td",15),g._UZ(206,"input",42),g.qZA(),g.TgZ(207,"td",15),g._UZ(208,"input",43),g.qZA(),g.qZA(),g.TgZ(209,"tr",11),g.TgZ(210,"th",14),g._uU(211,"Consistency"),g.qZA(),g.TgZ(212,"td",15),g._UZ(213,"input",44),g.qZA(),g.TgZ(214,"td",15),g._UZ(215,"input",45),g.qZA(),g.TgZ(216,"td",15),g._UZ(217,"input",46),g.qZA(),g.TgZ(218,"td",15),g._UZ(219,"input",47),g.qZA(),g.TgZ(220,"td",15),g._UZ(221,"input",48),g.qZA(),g.TgZ(222,"td",15),g._UZ(223,"input",49),g.qZA(),g.TgZ(224,"td",15),g._UZ(225,"input",50),g.qZA(),g.qZA(),g.TgZ(226,"tr",11),g.TgZ(227,"th",14),g._uU(228,"Readability "),g.qZA(),g.TgZ(229,"td",15),g._UZ(230,"input",51),g.qZA(),g.TgZ(231,"td",15),g._UZ(232,"input",52),g.qZA(),g.TgZ(233,"td",15),g._UZ(234,"input",53),g.qZA(),g.TgZ(235,"td",15),g._UZ(236,"input",54),g.qZA(),g.TgZ(237,"td",15),g._UZ(238,"input",55),g.qZA(),g.TgZ(239,"td",15),g._UZ(240,"input",56),g.qZA(),g.TgZ(241,"td",15),g._UZ(242,"input",57),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA()),2&t){const t=g.oxw();g.Q6J("formGroup",t.currentForm)}}const y=function(t){return{"current-item":t}};function I(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"div",59),g.NdJ("click",function(){const e=g.CHM(t).index;return g.oxw().changeIndex(e)}),g.TgZ(1,"span"),g._uU(2),g.qZA(),g.qZA()}if(2&t){const t=e.index,i=g.oxw();g.Q6J("ngClass",g.VKq(2,y,i.currentIndex===t)),g.xp6(2),g.Oqu(t+1)}}let C=(()=>{class t{constructor(t,e,i,r,n,o){this.projectsService=t,this.imagesService=e,this.route=i,this.designsService=r,this.ratingsService=n,this.fb=o,this.currentIndex=0,this.isFirstImageLoading=!1,this.isSecondImageLoading=!1,this.isResultBeingSubmitted=!1}get raterId(){return this.route.snapshot.paramMap.get("id")}ngOnInit(){this.projectsService.fetchAllProjects(0,0).subscribe(t=>{this.projects=t.results,this.refetchNewDesigns()})}changeIndex(t){this.currentIndex=t,this.refetchNewDesigns()}submitResults(){var t,e;null===(t=this.currentForm)||void 0===t||t.markAllAsTouched(),this.currentDesigns&&this.raterId&&(null===(e=this.currentForm)||void 0===e?void 0:e.valid)&&(this.isResultBeingSubmitted=!0,(0,u.D)([this.uploadDesignResult(!0),this.uploadDesignResult(!1)]).subscribe(t=>{this.isResultBeingSubmitted=!1}))}uploadDesignResult(t){var e,i,r,n,o,a,Z,g,c,p,l,m,h;const A=t?0:1,q=t?"firstDesign":"secondDesign";return this.currentDesigns&&this.raterId&&(null===(e=this.currentForm)||void 0===e?void 0:e.valid)?(0,u.D)([this.ratingsService.createOrUpdateRating({designId:this.currentDesigns[A]._id,aspect:d.u.ALIGNMENT,raterId:this.raterId,rating:null===(r=null===(i=this.currentForm)||void 0===i?void 0:i.get(q))||void 0===r?void 0:r.get("alignment").value}),this.ratingsService.createOrUpdateRating({designId:this.currentDesigns[A]._id,aspect:d.u.APPROPRIATENESS,raterId:this.raterId,rating:null===(o=null===(n=this.currentForm)||void 0===n?void 0:n.get(q))||void 0===o?void 0:o.get("appropriateness").value}),this.ratingsService.createOrUpdateRating({designId:this.currentDesigns[A]._id,aspect:d.u.HIERARCHY,raterId:this.raterId,rating:null===(Z=null===(a=this.currentForm)||void 0===a?void 0:a.get(q))||void 0===Z?void 0:Z.get("hierarchy").value}),this.ratingsService.createOrUpdateRating({designId:this.currentDesigns[A]._id,aspect:d.u.READABILITY,raterId:this.raterId,rating:null===(c=null===(g=this.currentForm)||void 0===g?void 0:g.get(q))||void 0===c?void 0:c.get("readability").value}),this.ratingsService.createOrUpdateRating({designId:this.currentDesigns[A]._id,aspect:d.u.CONSISTENCY,raterId:this.raterId,rating:null===(l=null===(p=this.currentForm)||void 0===p?void 0:p.get(q))||void 0===l?void 0:l.get("consistency").value}),this.ratingsService.createOrUpdateRating({designId:this.currentDesigns[A]._id,aspect:d.u.EMPHASIS,raterId:this.raterId,rating:null===(h=null===(m=this.currentForm)||void 0===m?void 0:m.get(q))||void 0===h?void 0:h.get("emphasis").value})]):(0,s.of)(void 0)}updateCurrentFormWithPreviousRatings(t,e){var i,r,n,o,a,u,s,Z,d,g,c,p;const l=e?"firstDesign":"secondDesign";null===(r=null===(i=this.currentForm)||void 0===i?void 0:i.get(l))||void 0===r||r.get("alignment").setValue(t.rating.ALIGNMENT),null===(o=null===(n=this.currentForm)||void 0===n?void 0:n.get(l))||void 0===o||o.get("emphasis").setValue(t.rating.EMPHASIS),null===(u=null===(a=this.currentForm)||void 0===a?void 0:a.get(l))||void 0===u||u.get("appropriateness").setValue(t.rating.APPROPRIATENESS),null===(Z=null===(s=this.currentForm)||void 0===s?void 0:s.get(l))||void 0===Z||Z.get("consistency").setValue(t.rating.CONSISTENCY),null===(g=null===(d=this.currentForm)||void 0===d?void 0:d.get(l))||void 0===g||g.get("hierarchy").setValue(t.rating.HIERARCHY),null===(p=null===(c=this.currentForm)||void 0===c?void 0:c.get(l))||void 0===p||p.get("readability").setValue(t.rating.READABILITY)}refetchNewDesigns(){this.currentForm=this.fb.group({firstDesign:this.fb.group({emphasis:[void 0,Z.kI.required],appropriateness:[void 0,Z.kI.required],hierarchy:[void 0,Z.kI.required],readability:[void 0,Z.kI.required],consistency:[void 0,Z.kI.required],alignment:[void 0,Z.kI.required]}),secondDesign:this.fb.group({emphasis:[void 0,Z.kI.required],appropriateness:[void 0,Z.kI.required],hierarchy:[void 0,Z.kI.required],readability:[void 0,Z.kI.required],consistency:[void 0,Z.kI.required],alignment:[void 0,Z.kI.required]})}),this.isFirstImageLoading=!0,this.isSecondImageLoading=!0,this.currentDesigns=[],this.projects&&this.raterId&&(0,u.D)(this.projects[this.currentIndex].designIds.map(t=>this.designsService.fetchDesignById(t))).pipe((0,o.P)()).subscribe(t=>{var e,i;this.currentDesigns=t,this.raterId&&(0,u.D)([this.ratingsService.fetchRatingByRaterIdAndDesignId(this.raterId,null===(e=this.currentDesigns)||void 0===e?void 0:e[0]._id),this.ratingsService.fetchRatingByRaterIdAndDesignId(this.raterId,null===(i=this.currentDesigns)||void 0===i?void 0:i[1]._id)]).subscribe(([t,e])=>{this.updateCurrentFormWithPreviousRatings(t.results[0],!0),this.updateCurrentFormWithPreviousRatings(e.results[0],!1)}),(0,u.D)(this.currentDesigns.map(t=>t.imageUrl?(0,s.of)({url:t.imageUrl}):t.imageId?this.imagesService.fetchImageById(t.imageId).pipe((0,a.U)(t=>Object.assign(Object.assign({},t),{url:`http://${t.url}`}))):(0,s.of)({}))).subscribe(t=>{this.currentImages=t,console.log(this.currentDesigns)})})}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(c.m),g.Y36(p.C),g.Y36(n.gz),g.Y36(l.i),g.Y36(m.w),g.Y36(Z.qu))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-rating-collection"]],decls:12,vars:8,consts:[["gdColumns","1fr 1fr","gdGap","300px",1,"image-container"],["class","image-size",3,"hidden","src",4,"ngIf"],["gdColumns","1fr 1fr","gdGap","300px","class","image-container",3,"formGroup",4,"ngIf"],[1,"image-container"],["mat-raised-button","","color","primary",3,"disabled","click"],["gdColumn","",1,"pagniation-container"],["fxLayout","row wrap","width","100%"],["fxFlex","30px","class","item",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"image-size",3,"hidden","src"],["gdColumns","1fr 1fr","gdGap","300px",1,"image-container",3,"formGroup"],["formGroupName","firstDesign",1,"table"],[1,"row"],["scope","col",1,"col-4"],["scope","col",1,"col"],["scope","row",1,"col-4"],[1,"col"],["type","radio","value","1","formControlName","appropriateness",1,"form-check-input"],["type","radio","value","2","formControlName","appropriateness",1,"form-check-input"],["type","radio","value","3","formControlName","appropriateness",1,"form-check-input"],["type","radio","value","4","formControlName","appropriateness",1,"form-check-input"],["type","radio","value","5","formControlName","appropriateness",1,"form-check-input"],["type","radio","value","6","formControlName","appropriateness",1,"form-check-input"],["type","radio","value","7","formControlName","appropriateness",1,"form-check-input"],["type","radio","value","1","formControlName","emphasis",1,"form-check-input"],["type","radio","value","2","formControlName","emphasis",1,"form-check-input"],["type","radio","value","3","formControlName","emphasis",1,"form-check-input"],["type","radio","value","4","formControlName","emphasis",1,"form-check-input"],["type","radio","value","5","formControlName","emphasis",1,"form-check-input"],["type","radio","value","6","formControlName","emphasis",1,"form-check-input"],["type","radio","value","7","formControlName","emphasis",1,"form-check-input"],["type","radio","value","1","formControlName","alignment",1,"form-check-input"],["type","radio","value","2","formControlName","alignment",1,"form-check-input"],["type","radio","value","3","formControlName","alignment",1,"form-check-input"],["type","radio","value","4","formControlName","alignment",1,"form-check-input"],["type","radio","value","5","formControlName","alignment",1,"form-check-input"],["type","radio","value","6","formControlName","alignment",1,"form-check-input"],["type","radio","value","7","formControlName","alignment",1,"form-check-input"],["type","radio","value","1","formControlName","hierarchy",1,"form-check-input"],["type","radio","value","2","formControlName","hierarchy",1,"form-check-input"],["type","radio","value","3","formControlName","hierarchy",1,"form-check-input"],["type","radio","value","4","formControlName","hierarchy",1,"form-check-input"],["type","radio","value","5","formControlName","hierarchy",1,"form-check-input"],["type","radio","value","6","formControlName","hierarchy",1,"form-check-input"],["type","radio","value","7","formControlName","hierarchy",1,"form-check-input"],["type","radio","value","1","formControlName","consistency",1,"form-check-input"],["type","radio","value","2","formControlName","consistency",1,"form-check-input"],["type","radio","value","3","formControlName","consistency",1,"form-check-input"],["type","radio","value","4","formControlName","consistency",1,"form-check-input"],["type","radio","value","5","formControlName","consistency",1,"form-check-input"],["type","radio","value","6","formControlName","consistency",1,"form-check-input"],["type","radio","value","7","formControlName","consistency",1,"form-check-input"],["type","radio","value","1","formControlName","readability",1,"form-check-input"],["type","radio","value","2","formControlName","readability",1,"form-check-input"],["type","radio","value","3","formControlName","readability",1,"form-check-input"],["type","radio","value","4","formControlName","readability",1,"form-check-input"],["type","radio","value","5","formControlName","readability",1,"form-check-input"],["type","radio","value","6","formControlName","readability",1,"form-check-input"],["type","radio","value","7","formControlName","readability",1,"form-check-input"],["formGroupName","secondDesign",1,"table"],["fxFlex","30px",1,"item",3,"ngClass","click"]],template:function(t,e){1&t&&(g.TgZ(0,"div",0),g.YNc(1,T,1,1,"img",1),g.YNc(2,_,1,1,"img",1),g.qZA(),g.YNc(3,U,243,1,"div",2),g.TgZ(4,"div",3),g.TgZ(5,"button",4),g.NdJ("click",function(){return e.submitResults()}),g._uU(6),g.qZA(),g.qZA(),g.TgZ(7,"div",5),g.TgZ(8,"h4"),g._uU(9,"All projects"),g.qZA(),g.TgZ(10,"div",6),g.YNc(11,I,3,4,"div",7),g.qZA(),g.qZA()),2&t&&(g.xp6(1),g.Q6J("ngIf",e.currentImages&&e.currentImages[0]),g.xp6(1),g.Q6J("ngIf",e.currentImages&&e.currentImages[1]),g.xp6(1),g.Q6J("ngIf",e.currentForm),g.xp6(2),g.Udp("width","100%"),g.Q6J("disabled",e.isResultBeingSubmitted),g.xp6(1),g.Oqu(e.isResultBeingSubmitted?"Loading":"Submit"),g.xp6(5),g.Q6J("ngForOf",e.projects))},directives:[h.OY,h.O7,r.O5,A.lW,h.Dl,q.xw,r.sg,Z.JL,Z.sg,Z.x0,Z._,Z.Fj,Z.JJ,v.P,Z.u,q.yH,r.mk,f.oO],styles:[".item[_ngcontent-%COMP%]{border:1px solid #000;text-align:center;line-height:30px;width:30px;height:30px;cursor:pointer;margin:10px}.item[_ngcontent-%COMP%]:hover{background-color:#0000004d}.finished-item[_ngcontent-%COMP%]{background-color:#08ad084d}.current-item[_ngcontent-%COMP%]{background-color:#000;color:#fff}.pagniation-container[_ngcontent-%COMP%]{margin:100px 10px 10px;width:100%}.image-size[_ngcontent-%COMP%]{width:100%;cursor:pointer}.image-size[_ngcontent-%COMP%]:hover{opacity:.7}.image-container[_ngcontent-%COMP%]{margin-left:20%;margin-right:20%;margin-top:40px}"]}),t})();var k=i(6277),N=i(9969);const b=[{path:":id",component:C}];let x=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=g.oAB({type:t}),t.\u0275inj=g.cJS({imports:[[r.ez,A.ot,Z.u5,N.m,Z.UX,k.o9,n.Bz.forChild(b)]]}),t})()}}]);